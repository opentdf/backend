import logging

logger = logging.getLogger(__name__)

def audit_hook(function_name, data, context, *args, **kwargs):
    logger.audit("------AUDIT_HOOK------")
    logger.audit(data)
    logger.audit(context)
    for arg in args:
        logger.audit(arg)
    for key, value in kwargs.items():
        logger.audit("%s == %s" % (key, value))
    logger.audit("-------------------------")
    # check if signed request token -- if not pass? or throw error? shouldnt get here without it
    # decode request token
    # decode bearer token
    # get iss and sub or azp
    # log statement
# {"asctime": "2023-01-10 22:30:35,942", "levelname": "AUDIT", "module": "hooks", "lineno": 7, "message": null, "signedRequestToken": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2NzMzODk4OTUsImlhdCI6MTY3MzM4OTgzNSwicmVxdWVzdEJvZHkiOiJ7XCJjbGllbnRQdWJsaWNLZXlcIjpcIi0tLS0tQkVHSU4gUFVCTElDIEtFWS0tLS0tXFxuTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFsWThXMGRrMXBWWkZoMnZETndSYVxcbmRmaVk4XC9vbExXUk1nTkdIcXliOUF5QjRBbURXeUpWWko2dFNKSGJ0cEFmTHA2TjNZXC9wSXZpRFpkMzE5SHpGU1xcbm9jc0JsV01UdVVRejk0MDZVWENsU012eGFmWkFsZ1pxRUtma1ZBdW5wY3VERmdmQnRZb2FPVWlaWnJKSGhvMkNcXG45YzFzaUpEVUtHTnJwb1NKZzFVOU1BaWVHRUN1cDBoVzMrajUxK0F3UUFnaGtyZHFFUVN2Z1pST3NGU2RoTEl3XFxuYW9FUVd1b3FCYkg2ejNKdUd3UFh2clpXZW9HSHJTOEhBYWNYT3hNTktaMkVjbjNOVmtNcnpMclJtNkpMVE1WZVxcblJQRlRwdUlEM3NLd3NNSE5NTkQzWHlMS21aWSsrOEl5d0xwTmZuV1wvbHVUN1wvaGlsV2tDTTJnaVRpXC9hNU9oUHJcXG5pUUlEQVFBQlxcbi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLVxcblwiLFwia2V5QWNjZXNzXCI6e1wicG9saWN5QmluZGluZ1wiOlwiTm1NeFpqbGhZVGhsWW1ZM1lXTmxOV0ZsT0RneE1EZGtNVEV6TXpJME5qZGtNMlF6TWpObU56RmlabU01T1RFME5qTXpOemswWkRNeU1XRTJabVpqTWc9PVwiLFwicHJvdG9jb2xcIjpcImthc1wiLFwidHlwZVwiOlwid3JhcHBlZFwiLFwidXJsXCI6XCJodHRwOlwvXC9sb2NhbGhvc3Q6NjU0MzJcL2FwaVwva2FzXCIsXCJ3cmFwcGVkS2V5XCI6XCJPcW56ZTdZRkVEN1dkVlZIbnI0ZElDWnp0SWREOFwvRjBpZUNRTFBrNU1EUGNDTVE5NE5YVzZ3THhKelJqeW14TURHcHRoZjdLSlExTDhhdk41K2k5ck00eDh2XC9ka2NFZXdBQWlvTHhSdk90VUFxQnY4RGZpNjFcL0RhUHlcL1BpeHJEM0pSZVdnT0VlQzN4ZVl0SjdIV1wvU2NidDFoOVNmaFBycUMwbHpSYm9WMEJJa21ZVEh1d2VpZkFtSEtTaGYyMUFkMEkrbjZvdjRLMWIxZTByQ3B0Zm5MS3BkTGxNOXlTZjBFOXVRXC90ekhhN1VwR1FsTEV4aUFSanpYcDJuQzljbmJWaGVqNjg0Q2VVUDZFbjk3bXpCakM3dHphcEVrdElTam50SUwwR1lFS1pOKzlVS3l4OUx2M3lwbFNSRWk0bSs0YmFvSGNWb0xOMitHbFd3R3dYTFE9PVwifSxcInBvbGljeVwiOlwiZXlKaWIyUjVJanA3SW1SaGRHRkJkSFJ5YVdKMWRHVnpJanBiZXlKaGRIUnlhV0oxZEdVaU9pSm9kSFJ3Y3pvdkwyVjRZVzF3YkdVdVkyOXRMMkYwZEhJdlEyeGhjM05wWm1sallYUnBiMjR2ZG1Gc2RXVXZVeUlzSW1ScGMzQnNZWGxPWVcxbElqb2lJaXdpYTJGelZYSnNJam9pYUhSMGNEb3ZMMnh2WTJGc2FHOXpkRG8yTlRRek1pOWhjR2t2YTJGeklpd2ljSFZpUzJWNUlqb2lJbjBzZXlKaGRIUnlhV0oxZEdVaU9pSm9kSFJ3Y3pvdkwyVjRZVzF3YkdVdVkyOXRMMkYwZEhJdlEwOUpMM1poYkhWbEwxQlNXQ0lzSW1ScGMzQnNZWGxPWVcxbElqb2lJaXdpYTJGelZYSnNJam9pYUhSMGNEb3ZMMnh2WTJGc2FHOXpkRG8yTlRRek1pOWhjR2t2YTJGeklpd2ljSFZpUzJWNUlqb2lJbjFkTENKa2FYTnpaVzBpT2x0ZGZTd2lkWFZwWkNJNklqRTNNREF5T1RJNUxXUmhPRGt0TkdOaFl5MDRabUZqTFdKbU1UZzNPVFJoWW1Ga1pTSjlcIn0ifQ.AXoEJpAWWPontcVZ4Eeg3J5tdceRWSwkixdmjAT7pFzNYFUO30KWlXmvizuzLvkzFq1698Oz_WR6KjYc3EoMxTg-7MfIh5cgaBla4BD5GxLLsaidzK333cKn9MoO-uhS2e4Vl_-5Xeie88HQizyXaLIHFRV_EM24Ze-rlR9QzCoJRnPPRMoLA-4m2q6uAqq9Z1Z3-vU903lXiQHJIuRS-GojIIEPPr4b5TqcS1FPvzQatjFJP3MjIwFBlfhZPJutPB68p9crymOfcvU3SkhqR9vLpWqBpbWAVYql2OOiZAWmQcWMjMBxvyQ47UHGeFPwkDJya3Woz_2PYe8x8uKxJg"}
# {"asctime": "2023-01-10 22:30:35,942", "levelname": "AUDIT", "module": "hooks", "lineno": 8, "message": "{'Host': 'localhost', 'X-Request-Id': '078ad41a086767a3d981621191256994', 'X-Real-Ip': '127.0.0.1', 'X-Forwarded-For': '127.0.0.1', 'X-Forwarded-Host': 'localhost', 'X-Forwarded-Port': '80', 'X-Forwarded-Proto': 'http', 'X-Forwarded-Scheme': 'http', 'X-Scheme': 'http', 'Content-Length': '2563', 'Authorization': 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJ5ZkgzOE5UWnRfVTdoZXljOGk2NVN5eTlrck5vcTRBV0ZiUkdDZ2NxSEFvIn0.eyJleHAiOjE2NzMzOTAxMzUsImlhdCI6MTY3MzM4OTgzNSwianRpIjoiYjIwNzZjOTctZjMzYS00MWU1LWIxODYtZGZhYmQ2ZDc1OTU3IiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo2NTQzMi9hdXRoL3JlYWxtcy90ZGYiLCJhdWQiOlsidGRmLWF0dHJpYnV0ZXMiLCJhY2NvdW50Il0sInN1YiI6ImExN2E0ZTZlLWM1YTMtNDcxYi05YTY3LTBlMWM1MjkzNzVjNiIsInR5cCI6IkJlYXJlciIsImF6cCI6InRkZi1jbGllbnQiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly9rZXljbG9hay1odHRwIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJkZWZhdWx0LXJvbGVzLXRkZiIsIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6ImVtYWlsIHByb2ZpbGUiLCJjbGllbnRIb3N0IjoiMTI3LjAuMC4xIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJjbGllbnRJZCI6InRkZi1jbGllbnQiLCJ0ZGZfY2xhaW1zIjp7ImVudGl0bGVtZW50cyI6W3siZW50aXR5X2lkZW50aWZpZXIiOiI1MjEwM2U1ZS03NmViLTQ1YzEtYjQxMi1mMGEyMzY3MzJiY2IiLCJlbnRpdHlfYXR0cmlidXRlcyI6W3siYXR0cmlidXRlIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9hdHRyL0NsYXNzaWZpY2F0aW9uL3ZhbHVlL1MiLCJkaXNwbGF5TmFtZSI6IkNsYXNzaWZpY2F0aW9uIn0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvQ09JL3ZhbHVlL1BSWCIsImRpc3BsYXlOYW1lIjoiQ09JIn0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvRW52L3ZhbHVlL0NsZWFuUm9vbSIsImRpc3BsYXlOYW1lIjoiRW52In0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvQ2xhc3NpZmljYXRpb24vdmFsdWUvUyIsImRpc3BsYXlOYW1lIjoiQ2xhc3NpZmljYXRpb24ifSx7ImF0dHJpYnV0ZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vYXR0ci9DT0kvdmFsdWUvUFJYIiwiZGlzcGxheU5hbWUiOiJDT0kifSx7ImF0dHJpYnV0ZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vYXR0ci9FbnYvdmFsdWUvQ2xlYW5Sb29tIiwiZGlzcGxheU5hbWUiOiJFbnYifSx7ImF0dHJpYnV0ZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vYXR0ci9DbGFzc2lmaWNhdGlvbi92YWx1ZS9TIiwiZGlzcGxheU5hbWUiOiJDbGFzc2lmaWNhdGlvbiJ9LHsiYXR0cmlidXRlIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9hdHRyL0NPSS92YWx1ZS9QUlgiLCJkaXNwbGF5TmFtZSI6IkNPSSJ9LHsiYXR0cmlidXRlIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9hdHRyL0Vudi92YWx1ZS9DbGVhblJvb20iLCJkaXNwbGF5TmFtZSI6IkVudiJ9LHsiYXR0cmlidXRlIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9hdHRyL0NsYXNzaWZpY2F0aW9uL3ZhbHVlL1MiLCJkaXNwbGF5TmFtZSI6IkNsYXNzaWZpY2F0aW9uIn0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvQ09JL3ZhbHVlL1BSWCIsImRpc3BsYXlOYW1lIjoiQ09JIn0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvRW52L3ZhbHVlL0NsZWFuUm9vbSIsImRpc3BsYXlOYW1lIjoiRW52In0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvQ2xhc3NpZmljYXRpb24vdmFsdWUvUyIsImRpc3BsYXlOYW1lIjoiQ2xhc3NpZmljYXRpb24ifSx7ImF0dHJpYnV0ZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vYXR0ci9DT0kvdmFsdWUvUFJYIiwiZGlzcGxheU5hbWUiOiJDT0kifSx7ImF0dHJpYnV0ZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vYXR0ci9FbnYvdmFsdWUvQ2xlYW5Sb29tIiwiZGlzcGxheU5hbWUiOiJFbnYifSx7ImF0dHJpYnV0ZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vYXR0ci9DbGFzc2lmaWNhdGlvbi92YWx1ZS9TIiwiZGlzcGxheU5hbWUiOiJDbGFzc2lmaWNhdGlvbiJ9LHsiYXR0cmlidXRlIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9hdHRyL0NPSS92YWx1ZS9QUlgiLCJkaXNwbGF5TmFtZSI6IkNPSSJ9LHsiYXR0cmlidXRlIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9hdHRyL0Vudi92YWx1ZS9DbGVhblJvb20iLCJkaXNwbGF5TmFtZSI6IkVudiJ9LHsiYXR0cmlidXRlIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9hdHRyL0NsYXNzaWZpY2F0aW9uL3ZhbHVlL1MiLCJkaXNwbGF5TmFtZSI6IkNsYXNzaWZpY2F0aW9uIn0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvQ09JL3ZhbHVlL1BSWCIsImRpc3BsYXlOYW1lIjoiQ09JIn0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvRW52L3ZhbHVlL0NsZWFuUm9vbSIsImRpc3BsYXlOYW1lIjoiRW52In0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvQ2xhc3NpZmljYXRpb24vdmFsdWUvUyIsImRpc3BsYXlOYW1lIjoiQ2xhc3NpZmljYXRpb24ifSx7ImF0dHJpYnV0ZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vYXR0ci9DT0kvdmFsdWUvUFJYIiwiZGlzcGxheU5hbWUiOiJDT0kifSx7ImF0dHJpYnV0ZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vYXR0ci9FbnYvdmFsdWUvQ2xlYW5Sb29tIiwiZGlzcGxheU5hbWUiOiJFbnYifSx7ImF0dHJpYnV0ZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vYXR0ci9DbGFzc2lmaWNhdGlvbi92YWx1ZS9TIiwiZGlzcGxheU5hbWUiOiJDbGFzc2lmaWNhdGlvbiJ9LHsiYXR0cmlidXRlIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9hdHRyL0NPSS92YWx1ZS9QUlgiLCJkaXNwbGF5TmFtZSI6IkNPSSJ9LHsiYXR0cmlidXRlIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9hdHRyL0Vudi92YWx1ZS9DbGVhblJvb20iLCJkaXNwbGF5TmFtZSI6IkVudiJ9LHsiYXR0cmlidXRlIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9hdHRyL0NsYXNzaWZpY2F0aW9uL3ZhbHVlL1MiLCJkaXNwbGF5TmFtZSI6IkNsYXNzaWZpY2F0aW9uIn0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvQ09JL3ZhbHVlL1BSWCIsImRpc3BsYXlOYW1lIjoiQ09JIn0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvRW52L3ZhbHVlL0NsZWFuUm9vbSIsImRpc3BsYXlOYW1lIjoiRW52In0seyJhdHRyaWJ1dGUiOiJodHRwczovL2V4YW1wbGUuY29tL2F0dHIvQ2xhc3NpZmljYXRpb24vdmFsdWUvUyIsImRpc3BsYXlOYW1lIjoiQ2xhc3NpZmljYXRpb24ifSx7ImF0dHJpYnV0ZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vYXR0ci9DT0kvdmFsdWUvUFJYIiwiZGlzcGxheU5hbWUiOiJDT0kifSx7ImF0dHJpYnV0ZSI6Imh0dHBzOi8vZXhhbXBsZS5jb20vYXR0ci9FbnYvdmFsdWUvQ2xlYW5Sb29tIiwiZGlzcGxheU5hbWUiOiJFbnYifV19XSwiY2xpZW50X3B1YmxpY19zaWduaW5nX2tleSI6Ii0tLS0tQkVHSU4gUFVCTElDIEtFWS0tLS0tXG5NSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQXk5N2UyeisyZTltQ21kcUxYS1ltXG5JS042NkY0Vzc3QnhwNG5aUHk0UDZlU1N5ZmlIbGd2UlFmVjFGYnRyblkxMHE5UlhxVUJEZDBsMm1zek5wZzgwXG50NXRRajl5TkNCRjlld2JuakdGWDV5TnorUXJKcll5UDdrMW9hMkxRRm9LNXBGelNEWEVOQVN5eTVCMlNpVlVLXG5mVFRXemRoemNlaWRWYVJsa0gwQzV4TkV3U3RvRG54ZXNFZ2M4L0UzWG1vVm9SYmkvR2lTelZpN0g0QzVrUUdmXG5ubkF4MmtWNzZ6YXFJMlZ5VTRMYlFBQXhQY0hFWW1yS2NxRmI1QUFkUGt0V1plZjZkcm1VUHZuNnZRNDc3NHZXXG5LNnJxTnRDRFcyZFVhM0tFLzlDeWpkeURGWjE4UHhlNW1zaGNVOWFXaFZlRFcxd05MVG10RnFncEI5bGczemxEXG5sd0lEQVFBQlxuLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0tXG4ifSwicHJlZmVycmVkX3VzZXJuYW1lIjoic2VydmljZS1hY2NvdW50LXRkZi1jbGllbnQiLCJjbGllbnRBZGRyZXNzIjoiMTI3LjAuMC4xIn0.r3W-NRSKg1_bMF_gl1Kn5Aqje2WFuFe8O7G1_Esbm66jdUq0BCR923dLwHH-ocCCw2vSrBf_AoS_jJ9JSjBJfgJm3ARy2n6SUX3bR6OqUmshPFe7iDwwyFHX6PWE2B5eJb5RgXnEYD6JSIlUPpolp_-uqtAMqsJMbYgVb56QYqFKhXvh6xymw9qu8xv7UFTkMhUI0p4RBWpE9DwlthBDIo89YpH8kTMfxDQ8j6o8EOZGadfNWdmjbZUfKq4PXwjRSOoIqxeXPhfQ9QlaBc21UVtD0y8RCW_SvRQDg6sDohmUp3N5kUPMgLiZTCiDvaPN8N2bDSUorvZj4cp-4xFqKQ', 'User-Agent': 'Openstack C++ SDK v1.0', 'X-Virtru-Client': 'openstack-cpp-sdk:1.0.0', 'Content-Type': 'application/json', 'Accept': 'application/json; charset=utf-8', 'Date': 'Tue, 10 Jan 2023 22:30:35 GMT'}"}


def err_audit_hook(http_method, function_name, err, *args, **kwargs):
    logger.audit("ERR_AUDIT_HOOK")
        # check if signed request token -- if not pass? or throw error? shouldnt get here without it
    # decode request token
    # decode bearer token
    # get iss and sub or azp
    # log statement
    # if http_method in [HttpMethod.POST, HttpMethod.PUT, HttpMethod.DELETE]:
    #     _audit_log(CallType.ERR, http_method, function_name, *args, **kwargs)
    # pass